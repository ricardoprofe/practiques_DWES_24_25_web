<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-UK" xml:lang="en-UK" >

<head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />        <title>Unit 12. Practice 12.1</title>
    <style>
        code{white-space: pre-wrap;}
        span.smallcaps{font-variant: small-caps;}
        div.columns{display: flex; gap: min(4vw, 1.5em);}
        div.column{flex: auto; overflow-x: auto;}
        div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
        /* The extra [class] is a hack that increases specificity enough to
           override a similar rule in reveal.js */
        ul.task-list[class]{list-style: none;}
        ul.task-list li input[type="checkbox"] {
          font-size: inherit;
          width: 0.8em;
          margin: 0 0.8em 0.2em -1.6em;
          vertical-align: middle;
        }
        .display.math{display: block; text-align: center; margin: 0.5rem auto;}
        /* CSS for syntax highlighting */
        pre > code.sourceCode { white-space: pre; position: relative; }
        pre > code.sourceCode > span { line-height: 1.25; }
        pre > code.sourceCode > span:empty { height: 1.2em; }
        .sourceCode { overflow: visible; }
        code.sourceCode > span { color: inherit; text-decoration: inherit; }
        div.sourceCode { margin: 1em 0; }
        pre.sourceCode { margin: 0; }
        @media screen {
        div.sourceCode { overflow: auto; }
        }
        @media print {
        pre > code.sourceCode { white-space: pre-wrap; }
        pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
        }
        pre.numberSource code
          { counter-reset: source-line 0; }
        pre.numberSource code > span
          { position: relative; left: -4em; counter-increment: source-line; }
        pre.numberSource code > span > a:first-child::before
          { content: counter(source-line);
            position: relative; left: -1em; text-align: right; vertical-align: baseline;
            border: none; display: inline-block;
            -webkit-touch-callout: none; -webkit-user-select: none;
            -khtml-user-select: none; -moz-user-select: none;
            -ms-user-select: none; user-select: none;
            padding: 0 4px; width: 4em;
            color: #aaaaaa;
          }
        pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
        div.sourceCode
          {  background-color: #f8f8f8; }
        @media screen {
        pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
        }
        code span.al { color: #ef2929; } /* Alert */
        code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
        code span.at { color: #204a87; } /* Attribute */
        code span.bn { color: #0000cf; } /* BaseN */
        code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
        code span.ch { color: #4e9a06; } /* Char */
        code span.cn { color: #8f5902; } /* Constant */
        code span.co { color: #8f5902; font-style: italic; } /* Comment */
        code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
        code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
        code span.dt { color: #204a87; } /* DataType */
        code span.dv { color: #0000cf; } /* DecVal */
        code span.er { color: #a40000; font-weight: bold; } /* Error */
        code span.ex { } /* Extension */
        code span.fl { color: #0000cf; } /* Float */
        code span.fu { color: #204a87; font-weight: bold; } /* Function */
        code span.im { } /* Import */
        code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
        code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
        code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
        code span.ot { color: #8f5902; } /* Other */
        code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
        code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
        code span.ss { color: #4e9a06; } /* SpecialString */
        code span.st { color: #4e9a06; } /* String */
        code span.va { color: #000000; } /* Variable */
        code span.vs { color: #4e9a06; } /* VerbatimString */
        code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
        <link rel="stylesheet" href="../web_template/aqua.css" />  
    <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
    <![endif]-->
      
</head>

<body>
    <div id="content">
                 <header id="title-block-header">
            <h1 class="title">Unit 12. Practice 12.1</h1>
            <!---->
            <!--  -->
                    </header>
                 <nav id="TOC" role="doc-toc">
            <div class="navContainer">
                 <ul>
<li><a href="#practice-14.1.-databases-with-doctrine"
id="toc-practice-14.1.-databases-with-doctrine"><span
class="toc-section-number">1</span> Practice 14.1. Databases with
Doctrine</a>
<ul>
<li><a href="#overview" id="toc-overview"><span
class="toc-section-number">1.1</span> Overview</a></li>
<li><a href="#exercise-1.-database-connection"
id="toc-exercise-1.-database-connection"><span
class="toc-section-number">1.2</span> Exercise 1. Database
connection</a></li>
<li><a href="#exercise-2.-creating-the-models"
id="toc-exercise-2.-creating-the-models"><span
class="toc-section-number">1.3</span> Exercise 2. Creating the
models</a></li>
<li><a href="#exercise-3.-select-queries"
id="toc-exercise-3.-select-queries"><span
class="toc-section-number">1.4</span> Exercise 3. Select
queries</a></li>
<li><a href="#exercise-4.-insert-queries"
id="toc-exercise-4.-insert-queries"><span
class="toc-section-number">1.5</span> Exercise 4. Insert
queries</a></li>
<li><a href="#exercise-5.-update-queries"
id="toc-exercise-5.-update-queries"><span
class="toc-section-number">1.6</span> Exercise 5. Update
queries</a></li>
<li><a href="#exercise-6.-delete-queries"
id="toc-exercise-6.-delete-queries"><span
class="toc-section-number">1.7</span> Exercise 6. Delete
queries</a></li>
<li><a href="#how-to-submit-to-github-classroom"
id="toc-how-to-submit-to-github-classroom"><span
class="toc-section-number">1.8</span> How to submit to GitHub
Classroom</a></li>
</ul></li>
</ul>
            </div>
        </nav>
                <main>
            <h1 data-number="1"
            id="practice-14.1.-databases-with-doctrine"><span
            class="header-section-number">1</span> Practice 14.1.
            Databases with Doctrine</h1>
            <blockquote>
            <p>This practice is the next of the series of practices,
            consisting of a Library application. Each practice will be
            based on the previous one. Before starting it, finish the
            previous one, make the corrections you consider, if needed,
            and start coding.</p>
            <p>Before start, create a new git branch named
            <code>library-u12</code> and switch to it:</p>
            <div class="sourceCode" id="cb1"><pre
            class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> branch library-u12</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout library-u12</span></code></pre></div>
            <p>Do all the practice in the <code>library-u12</code>
            branch. Once finished, do the submission via GitHub
            Classroom as detailed at the end of the practice.</p>
            </blockquote>
            <h2 data-number="1.1" id="overview"><span
            class="header-section-number">1.1</span> Overview</h2>
            <p>In this practice we’re going to do the models and the
            databases access classes for our library app using Doctrine
            and the tools provided by Symfony. Some of the database
            operations, such inserts and updates will be coded
            “manually” and in the next unit we will learn how to do
            these operations with an API.</p>
            <figure>
            <img src="images/library-symfony.drawio.png"
            alt="Database schema" />
            <figcaption aria-hidden="true">Database schema</figcaption>
            </figure>
            <h2 data-number="1.2"
            id="exercise-1.-database-connection"><span
            class="header-section-number">1.2</span> Exercise 1.
            Database connection</h2>
            <p>Create a <code>.env.local</code> file with the database
            connection string:</p>
            <pre><code>DATABASE_URL=&quot;mysql://user:password@127.0.0.1:3306/
librarysymfony?serverVersion=8&amp;charset=utf8mb4&quot;</code></pre>
            <p>or, if you are using MariaDb:</p>
            <pre><code>DATABASE_URL=&quot;mysql://user:password@127.0.0.1:3306/
librarysymfony?serverVersion=10.11.2-MariaDB&amp;charset=utf8mb4&quot;</code></pre>
            <p>The database name must be
            <strong><code>librarysymfony</code></strong>. Use the
            username and password you want.</p>
            <h2 data-number="1.3"
            id="exercise-2.-creating-the-models"><span
            class="header-section-number">1.3</span> Exercise 2.
            Creating the models</h2>
            <p>Create, using Symfony, the models <strong>Book</strong>
            and <strong>Publisher</strong> according to the schema. Make
            sure that it accomplishes the relation: each book can have
            zero or one publisher and each publisher can have zero or
            many books.</p>
            <p>The description of the tables must be:</p>
            <div class="sourceCode" id="cb4"><pre
            class="sourceCode sql"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mysql<span class="op">&gt;</span> describe book;</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">--------------+--------------+------+-----+---------+-------+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>| Field        | <span class="kw">Type</span>         | <span class="kw">Null</span> | <span class="kw">Key</span> | <span class="kw">Default</span> | Extra |</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">--------------+--------------+------+-----+---------+-------+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>| isbn         | <span class="dt">varchar</span>(<span class="dv">25</span>)  | <span class="kw">NO</span>   | PRI | <span class="kw">NULL</span>    |       |</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>| publisher_id | <span class="dt">int</span>(<span class="dv">11</span>)      | YES  | MUL | <span class="kw">NULL</span>    |       |</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>| title        | <span class="dt">varchar</span>(<span class="dv">100</span>) | <span class="kw">NO</span>   |     | <span class="kw">NULL</span>    |       |</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>| author       | <span class="dt">varchar</span>(<span class="dv">100</span>) | YES  |     | <span class="kw">NULL</span>    |       |</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>| pages        | <span class="dt">int</span>          | YES  |     | <span class="kw">NULL</span>    |       |</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>| pub_date     | <span class="dt">date</span>         | YES  |     | <span class="kw">NULL</span>    |       |</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">--------------+--------------+------+-----+---------+-------+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>mysql<span class="op">&gt;</span> describe publisher;</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">-------+--------------+------+-----+---------+----------------+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>| Field | <span class="kw">Type</span>         | <span class="kw">Null</span> | <span class="kw">Key</span> | <span class="kw">Default</span> | Extra          |</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">-------+--------------+------+-----+---------+----------------+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>| <span class="kw">id</span>    | <span class="dt">int</span>          | <span class="kw">NO</span>   | PRI | <span class="kw">NULL</span>    | auto_increment |</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>| name  | <span class="dt">varchar</span>(<span class="dv">100</span>) | <span class="kw">NO</span>   |     | <span class="kw">NULL</span>    |                |</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>| email | <span class="dt">varchar</span>(<span class="dv">100</span>) | YES  |     | <span class="kw">NULL</span>    |                |</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">-------+--------------+------+-----+---------+----------------+</span></span></code></pre></div>
            <p>In addition, you can use the next data if you want some
            sample data to check the queries:</p>
            <div class="sourceCode" id="cb5"><pre
            class="sourceCode sql"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> `publisher` (`id`, `name`, `email`) <span class="kw">VALUES</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">NULL</span>, <span class="st">&#39;Clarion Books&#39;</span>, <span class="st">&#39;info@clarion.com&#39;</span>), </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">NULL</span>, <span class="st">&#39;Ecco&#39;</span>, <span class="st">&#39;ecco_info@ecco.com&#39;</span>), </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">NULL</span>, <span class="st">&#39;Scribner&#39;</span>, <span class="st">&#39;scribner@scr.com&#39;</span>);</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">INSERT</span> <span class="kw">INTO</span> `book` (`isbn`, `publisher_id`, `title`, `author`, `pages`, `pub_date`) <span class="kw">VALUES</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  (<span class="st">&#39;A111B3&#39;</span>, <span class="st">&#39;1&#39;</span>, <span class="st">&#39;The Lord of the Rings&#39;</span>, <span class="st">&#39;J.R.R. Tolkien&#39;</span>, <span class="st">&#39;1536&#39;</span>, <span class="st">&#39;2020-11-03&#39;</span>), </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  (<span class="st">&#39;C221B6&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;Factotum&#39;</span>, <span class="st">&#39;Charles Bukowski&#39;</span>, <span class="st">&#39;208&#39;</span>, <span class="st">&#39;2002-03-31&#39;</span>), </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  (<span class="st">&#39;A546783&#39;</span>, <span class="st">&#39;1&#39;</span>, <span class="st">&#39;A Wizard of Earthsea&#39;</span>, <span class="st">&#39;Ursula K. Le Guin&#39;</span>, <span class="st">&#39;210&#39;</span>, <span class="st">&#39;2012-09-11&#39;</span>), </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  (<span class="st">&#39;F666764&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;The Lathe Of Heaven&#39;</span>, <span class="st">&#39;Ursula K. Le Guin&#39;</span>, <span class="st">&#39;192&#39;</span>, <span class="st">&#39;2008-04-15&#39;</span>), </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  (<span class="st">&#39;66788745&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;Foundation&#39;</span>, <span class="st">&#39;Isaac Asimov&#39;</span>, <span class="st">&#39;816&#39;</span>, <span class="st">&#39;2022-07-07&#39;</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  (<span class="st">&#39;A343445&#39;</span>, <span class="kw">NULL</span>, <span class="st">&#39;El Lazarillo de Tormes&#39;</span>, <span class="kw">NULL</span>, <span class="st">&#39;103&#39;</span>, <span class="kw">NULL</span>);</span></code></pre></div>
            <h2 data-number="1.4" id="exercise-3.-select-queries"><span
            class="header-section-number">1.4</span> Exercise 3. Select
            queries</h2>
            <p>Do the next queries:</p>
            <table>
            <colgroup>
            <col style="width: 25%" />
            <col style="width: 25%" />
            <col style="width: 50%" />
            </colgroup>
            <thead>
            <tr class="header">
            <th>Query</th>
            <th>Template</th>
            <th style="text-align: left;">Route</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>Select a publisher by its id</td>
            <td>single publisher</td>
            <td
            style="text-align: left;"><code>/publisher/{id&lt;\d+&gt;}</code></td>
            </tr>
            <tr class="even">
            <td>Select all the publishers</td>
            <td>publisher list</td>
            <td
            style="text-align: left;"><code>/publisher_list</code></td>
            </tr>
            <tr class="odd">
            <td>Search a publisher by its name</td>
            <td>publisher list</td>
            <td
            style="text-align: left;"><code>/publisher/search/{name}</code></td>
            </tr>
            <tr class="even">
            <td>Select a book by its isbn</td>
            <td>single book</td>
            <td style="text-align: left;"><code>/book/{isbn}</code></td>
            </tr>
            <tr class="odd">
            <td>Select all the books</td>
            <td>book list</td>
            <td style="text-align: left;"><code>/book_list</code></td>
            </tr>
            <tr class="even">
            <td>Search a book by its title AND author</td>
            <td>book list</td>
            <td
            style="text-align: left;"><code>/book/search/{title}/{author}</code></td>
            </tr>
            </tbody>
            </table>
            <p>As an example for the last query, if we are using the
            data set of the previous point and the query string is
            <code>/search/the</code> the result will be
            <em><code>The Lord of the Rings</code></em> and
            <em><code>The Late of Heaven</code></em>. If the query is
            <code>/search/the/ursula</code> the result will be only
            <em><code>The Late of Heaven</code></em>.</p>
            <h2 data-number="1.5" id="exercise-4.-insert-queries"><span
            class="header-section-number">1.5</span> Exercise 4. Insert
            queries</h2>
            <p>Do the queries to insert a new publisher and a new book.
            These queries must be done manually in the code with sample
            data for each one.</p>
            <p>The routes must be:</p>
            <ul>
            <li><code>/book/new</code></li>
            <li><code>/publisher/new</code></li>
            </ul>
            <p>Create a new template for each one.</p>
            <h2 data-number="1.6" id="exercise-5.-update-queries"><span
            class="header-section-number">1.6</span> Exercise 5. Update
            queries</h2>
            <p>Do the queries to update a single book and a single
            publisher. These queries must be done manually in the code
            with sample data for each one.</p>
            <p>The routes must be:</p>
            <ul>
            <li><code>/book/edit/{isbn}</code></li>
            <li><code>/publisher/edit/{id&lt;\d+&gt;}</code></li>
            </ul>
            <p>You can reuse the same templates of the previous point
            but with a different message or you can create new
            templates.</p>
            <h2 data-number="1.7" id="exercise-6.-delete-queries"><span
            class="header-section-number">1.7</span> Exercise 6. Delete
            queries</h2>
            <p>Do the queries to delete a single book and a single
            publisher. These queries must be done manually in the code
            with sample data for each one.</p>
            <p>The routes must be:</p>
            <ul>
            <li><code>/book/delete/{isbn}</code></li>
            <li><code>/publisher/delete/{id&lt;\d+&gt;}</code></li>
            </ul>
            <p>You can reuse the same templates of the previous point
            but with a different message or you can create new
            templates.</p>
            <h2 data-number="1.8"
            id="how-to-submit-to-github-classroom"><span
            class="header-section-number">1.8</span> How to submit to
            GitHub Classroom</h2>
            <p>Once you finish the task, make a commit with the comment
            “PRACTICE 12.1 SUBMISSION COMMIT” and push it to GitHub.</p>
            <ol type="1">
            <li>This task must be submitted to the same repository of
            the previous one. Remember to make a new branch before
            starting the practice.</li>
            <li>Once you finish the task, make a commit with the comment
            “PRACTICE 12.1 SUBMISSION COMMIT”, merge the branch into the
            main branch, and push it to GitHub. For example:</li>
            </ol>
            <div class="sourceCode" id="cb6"><pre
            class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">&quot;PRACTICE 12.1 SUBMISSION COMMIT&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout main</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> merge library-u12</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span></code></pre></div>
            <ol start="3" type="1">
            <li><p>It’s recommended to tag your commit with the tag
            “Practice_12.1”.</p></li>
            <li><p>Before that, you can do the commits and push you
            want. If you change your code after your submission commit,
            make another commit and push with the same text in the
            message adding the corrections you’ve done.</p></li>
            </ol>
            <p>If you have any doubt in your task, you can push your
            code and ask me by email what’s your problem. It will make
            it easier for both the solutions of code issues.</p>
        </main>
        

        <!--- Modal images -->

        <!-- The Modal -->
        <div id="myModal" class="modal">

            <!-- The Close Button -->
            <!--span class="close">&times;</span-->

            <!-- Modal Content (The Image) -->
            <img class="modal-content" id="img01">

            <!-- Modal Caption (Image Text) -->
            <div id="caption"></div>
        </div>

        <!-- End Modal Images -->

        <!-- Snackbar for copy code -->
        <div id="snackbar">Codi copiat!</div>
        <!-- End Snackbar -->

        <script>
            function ModalizeImages() {
                // Script basat en https://www.w3schools.com/howto/howto_css_modal_images.asp
                // PEr ampliar imatges en fer click

                // Get the modal
                var modal = document.getElementById("myModal");

                var modalImg = document.getElementById("img01");
                var captionText = document.getElementById("caption");

                // Get the image and insert it inside the modal - use its "alt" text as a caption
                //var img = document.getElementById("myImg");
                document.querySelectorAll("img").forEach((img => {
                        img.onclick = function() {
                            modal.style.display = "block";
                            modalImg.src = this.src;
                            captionText.innerHTML = this.alt;
                        }
                    }))
                    // Get the <span> element that closes the modal
                var span = document.getElementsByClassName("close")[0];

                // When the user clicks on <span> (x), close the modal
                //span.onclick = function() {
                myModal.onclick = function() {
                    modal.style.display = "none";
                }


            }


            function markItem(id) {
                // Restaurem format de tots
                document.querySelectorAll("#TOC a").forEach(function(item) {
                        //item.style.fontWeight = "300";
                        item.classList.remove("navItemSelected");
                    })
                    //item.style.color = "#ff0000";

                // Afegim format
                let items = document.querySelectorAll("#TOC a[href='#" + id + "']");
                items.forEach(function(item) {
                    //item.style.fontWeight = "bolder";
                    item.classList.add("navItemSelected");
                })

            }

            var observer = new IntersectionObserver(function(entries) {
                // isIntersecting is true when element and viewport are overlapping
                // isIntersecting is false when element and viewport don't overlap
                if (entries[0].isIntersecting === true) {
                    let id = entries[0].target.id;
                    markItem(id);
                }

            }, {
                threshold: [0]
            });

            window.addEventListener("load", function() {
                document.querySelectorAll("h1, h2, h3").forEach(function(item) {
                    observer.observe(item);
                });

                document.querySelectorAll("#TOC a").forEach(function(item) {
                    item.addEventListener("click", function(item) {
                        markItem(item.id);
                    })
                })

                // Fem modals totes les imatges
                ModalizeImages();
            })

            document.querySelector("#TOC").addEventListener("click", function(event) {
                let toc = event.target
                if (toc.offsetWidth > 10) {
                    toc.classList.add("minimizedToc");
                }
            })

            document.querySelector("#TOC").addEventListener("mouseover", function(event) {
                let toc = event.target
                if (toc.classList.contains("minimizedToc"))
                    toc.classList.remove("minimizedToc");
            })


                        
            /* PER COPIAR CODI */


            // Busca tots els elements amb la classe "sourceCode"
            var sourceCodeElements = document.querySelectorAll('div.sourceCode');

            /*Afegim el botó a tots els divs */
            // Afegir un botó per a cada element "sourceCode"
            sourceCodeElements.forEach(function(element) {
                console.log(element.id);
                var button = document.createElement('div');
                button.className = 'button-copy';

                // Afegir una icona al botó (fa servir FontAwesome com a exemple)
                //var icon = document.createElement('i');
                //icon.className = 'fas fa-copy'; // Utilitza l'ícona "copy" de FontAwesome

                // Obté l'ID de l'element actual
                var elementId = element.id;

                // Afegeix un event listener al botó per cridar la funció amb l'ID
                button.addEventListener('click', function() {
                    copyContent(elementId);
                });

                // Afegeix l'icona al botó i el botó just dins de l'element "sourceCode"
                //button.appendChild(icon);
                element.appendChild(button);
            });



            // Funció per copiar el contingut d'un element amb l'ID donat
            function copyContent(elementId) {
                var element = document.getElementById(elementId);
                var textToCopy = element.innerText;

                // Crea un element de text i copia el contingut
                var textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);

                // Selecciona i copia el text
                textArea.select();
                document.execCommand('copy');

                // Elimina l'element de text afegit temporalment
                document.body.removeChild(textArea);

                // Notifica a l'usuari que el codi s'ha copiat
                mostraSnackbar();
            }

            /* SNACKBAR EN COPIAR CODI */

            function mostraSnackbar() {
            // Busquem l'snackbar
            var x = document.getElementById("snackbar");

            // Li afegim la classe show
            x.className = "show";

            // I als tres segons la llevem
            setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
            } 




        </script>
    </div>
</body>

</html>