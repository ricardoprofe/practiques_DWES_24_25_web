<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-UK" xml:lang="en-UK" >

<head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />        <title>Unit 13. Practice 13.1</title>
    <style>
        code{white-space: pre-wrap;}
        span.smallcaps{font-variant: small-caps;}
        div.columns{display: flex; gap: min(4vw, 1.5em);}
        div.column{flex: auto; overflow-x: auto;}
        div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
        /* The extra [class] is a hack that increases specificity enough to
           override a similar rule in reveal.js */
        ul.task-list[class]{list-style: none;}
        ul.task-list li input[type="checkbox"] {
          font-size: inherit;
          width: 0.8em;
          margin: 0 0.8em 0.2em -1.6em;
          vertical-align: middle;
        }
        .display.math{display: block; text-align: center; margin: 0.5rem auto;}
        /* CSS for syntax highlighting */
        pre > code.sourceCode { white-space: pre; position: relative; }
        pre > code.sourceCode > span { line-height: 1.25; }
        pre > code.sourceCode > span:empty { height: 1.2em; }
        .sourceCode { overflow: visible; }
        code.sourceCode > span { color: inherit; text-decoration: inherit; }
        div.sourceCode { margin: 1em 0; }
        pre.sourceCode { margin: 0; }
        @media screen {
        div.sourceCode { overflow: auto; }
        }
        @media print {
        pre > code.sourceCode { white-space: pre-wrap; }
        pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
        }
        pre.numberSource code
          { counter-reset: source-line 0; }
        pre.numberSource code > span
          { position: relative; left: -4em; counter-increment: source-line; }
        pre.numberSource code > span > a:first-child::before
          { content: counter(source-line);
            position: relative; left: -1em; text-align: right; vertical-align: baseline;
            border: none; display: inline-block;
            -webkit-touch-callout: none; -webkit-user-select: none;
            -khtml-user-select: none; -moz-user-select: none;
            -ms-user-select: none; user-select: none;
            padding: 0 4px; width: 4em;
            color: #aaaaaa;
          }
        pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
        div.sourceCode
          {  background-color: #f8f8f8; }
        @media screen {
        pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
        }
        code span.al { color: #ef2929; } /* Alert */
        code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
        code span.at { color: #204a87; } /* Attribute */
        code span.bn { color: #0000cf; } /* BaseN */
        code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
        code span.ch { color: #4e9a06; } /* Char */
        code span.cn { color: #8f5902; } /* Constant */
        code span.co { color: #8f5902; font-style: italic; } /* Comment */
        code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
        code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
        code span.dt { color: #204a87; } /* DataType */
        code span.dv { color: #0000cf; } /* DecVal */
        code span.er { color: #a40000; font-weight: bold; } /* Error */
        code span.ex { } /* Extension */
        code span.fl { color: #0000cf; } /* Float */
        code span.fu { color: #204a87; font-weight: bold; } /* Function */
        code span.im { } /* Import */
        code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
        code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
        code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
        code span.ot { color: #8f5902; } /* Other */
        code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
        code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
        code span.ss { color: #4e9a06; } /* SpecialString */
        code span.st { color: #4e9a06; } /* String */
        code span.va { color: #000000; } /* Variable */
        code span.vs { color: #4e9a06; } /* VerbatimString */
        code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
        <link rel="stylesheet" href="../web_template/aqua.css" />  
    <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
    <![endif]-->
      
</head>

<body>
    <div id="content">
                 <header id="title-block-header">
            <h1 class="title">Unit 13. Practice 13.1</h1>
            <!---->
            <!--  -->
                    </header>
                 <nav id="TOC" role="doc-toc">
            <div class="navContainer">
                 <ul>
<li><a href="#practice-13.1.-rest-web-service-with-symfony"
id="toc-practice-13.1.-rest-web-service-with-symfony"><span
class="toc-section-number">1</span> Practice 13.1. REST web service with
Symfony</a>
<ul>
<li><a href="#overview" id="toc-overview"><span
class="toc-section-number">1.1</span> Overview</a></li>
<li><a href="#exercise-1.-rest-web-services"
id="toc-exercise-1.-rest-web-services"><span
class="toc-section-number">1.2</span> Exercise 1. REST Web
services</a></li>
<li><a href="#exercise-2.-validation"
id="toc-exercise-2.-validation"><span
class="toc-section-number">1.3</span> Exercise 2. Validation</a></li>
<li><a href="#exercise-3.-authentication-and-authorization"
id="toc-exercise-3.-authentication-and-authorization"><span
class="toc-section-number">1.4</span> Exercise 3. Authentication and
authorization</a></li>
<li><a href="#how-to-submit-to-github-classroom"
id="toc-how-to-submit-to-github-classroom"><span
class="toc-section-number">1.5</span> How to submit to GitHub
Classroom</a></li>
</ul></li>
</ul>
            </div>
        </nav>
                <main>
            <h1 data-number="1"
            id="practice-13.1.-rest-web-service-with-symfony"><span
            class="header-section-number">1</span> Practice 13.1. REST
            web service with Symfony</h1>
            <blockquote>
            <p>This practice is the next of the series of practices,
            consisting of a Library application. Each practice will be
            based on the previous one. Before starting it, finish the
            previous one, make the corrections you consider, if needed,
            and start coding.</p>
            <p>Before start, create a new git branch named
            <code>library-u13</code> and switch to it:</p>
            <div class="sourceCode" id="cb1"><pre
            class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> branch library-u13</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout library-u13</span></code></pre></div>
            <p>Do all the practice in the <code>library-u13</code>
            branch. Once finished, do the submission via GitHub
            Classroom as detailed at the end of the practice.</p>
            </blockquote>
            <h2 data-number="1.1" id="overview"><span
            class="header-section-number">1.1</span> Overview</h2>
            <p>In this practice we’re going to do an API REST for the
            app. The app will have 3 access levels:</p>
            <ul>
            <li><strong>Public access</strong>: can access the login and
            register url’s.</li>
            <li><strong>Registered users</strong>: can access all the
            url’s to list, view and search for books and publishers, but
            can not edit, delete or add any data.</li>
            <li><strong>Admin users</strong>: can access all the url’s
            and can edit, delete and add all the data.</li>
            </ul>
            <p><strong>The api must be done with <em>API
            Platform</em></strong>, not manually.</p>
            <h2 data-number="1.2"
            id="exercise-1.-rest-web-services"><span
            class="header-section-number">1.2</span> Exercise 1. REST
            Web services</h2>
            <p>Build the next web services:</p>
            <table>
            <colgroup>
            <col style="width: 25%" />
            <col style="width: 25%" />
            <col style="width: 25%" />
            <col style="width: 25%" />
            </colgroup>
            <thead>
            <tr class="header">
            <th>Action</th>
            <th>Method</th>
            <th>Route</th>
            <th>Notes</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>List of all books</td>
            <td>GET</td>
            <td>/api/books/</td>
            <td></td>
            </tr>
            <tr class="even">
            <td>Single book</td>
            <td>GET</td>
            <td>/api/books/{isbn}</td>
            <td></td>
            </tr>
            <tr class="odd">
            <td>List of all publishers</td>
            <td>GET</td>
            <td>/api/publishers/</td>
            <td></td>
            </tr>
            <tr class="even">
            <td>Single publisher</td>
            <td>GET</td>
            <td>/api/publishers/{id}</td>
            <td></td>
            </tr>
            <tr class="odd">
            <td>Insert a new book</td>
            <td>POST</td>
            <td>/api/books/</td>
            <td>The book must have an existing publisher identified by
            its <code>id</code></td>
            </tr>
            <tr class="even">
            <td>Insert a new publisher</td>
            <td>POST</td>
            <td>/api/publishers/</td>
            <td></td>
            </tr>
            <tr class="odd">
            <td>Update a book</td>
            <td>PUT</td>
            <td>/api/books/{isbn}</td>
            <td>The book must have an existing publisher identified by
            its <code>id</code></td>
            </tr>
            <tr class="even">
            <td>Update a publisher</td>
            <td>PUT</td>
            <td>/api/publishers/{id}</td>
            <td></td>
            </tr>
            <tr class="odd">
            <td>Delete a book</td>
            <td>DELETE</td>
            <td>/api/books/{isbn}</td>
            <td></td>
            </tr>
            <tr class="even">
            <td>Delete a publisher</td>
            <td>DELETE</td>
            <td>/api/publishers/{id}</td>
            <td></td>
            </tr>
            <tr class="odd">
            <td>List of all books of a single publisher</td>
            <td>GET</td>
            <td>/api/publishers/{id}/books</td>
            <td></td>
            </tr>
            </tbody>
            </table>
            <p>Hide the operations not listed (PATCH).</p>
            <p>The GET books operations must show the publisher’s data
            as part of the response. For instance:</p>
            <figure>
            <img src="images/get-book.png"
            alt="Get books with publisher info" />
            <figcaption aria-hidden="true">Get books with publisher
            info</figcaption>
            </figure>
            <h2 data-number="1.3" id="exercise-2.-validation"><span
            class="header-section-number">1.3</span> Exercise 2.
            Validation</h2>
            <p>Make sure that the data are <strong>validated</strong>
            following the next rules, before adding them to the
            database:</p>
            <ul>
            <li>Book:
            <ul>
            <li>ISBN and title, required</li>
            <li>Pages, a numeric value equal or greater than zero.</li>
            </ul></li>
            <li>Publisher:
            <ul>
            <li>Name, required.</li>
            <li>Email, not required and email format.</li>
            </ul></li>
            </ul>
            <p>Some examples of queries:</p>
            <div class="sourceCode" id="cb2"><pre
            class="sourceCode json"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="er">//</span> <span class="er">Correct</span> <span class="er">POST</span> <span class="er">request:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="er">POST</span> <span class="er">localhost:8000/api/books/</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;isbn&quot;</span><span class="fu">:</span> <span class="st">&quot;A111B7&quot;</span><span class="fu">,</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;The Hobbit&quot;</span><span class="fu">,</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;author&quot;</span><span class="fu">:</span> <span class="st">&quot;J.R.R. Tolkien&quot;</span><span class="fu">,</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;pages&quot;</span><span class="fu">:</span> <span class="dv">677</span><span class="fu">,</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;pub_date&quot;</span><span class="fu">:</span> <span class="st">&quot;2020-11-03&quot;</span><span class="fu">,</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;publisher&quot;</span><span class="fu">:</span> <span class="st">&quot;/api/publishers/2&quot;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
            <div class="sourceCode" id="cb3"><pre
            class="sourceCode json"><code class="sourceCode json"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="er">//</span> <span class="er">Incorrect</span> <span class="er">PUT</span> <span class="er">request,</span> <span class="er">pages</span> <span class="er">less</span> <span class="er">than</span> <span class="er">zero:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="er">PUT</span> <span class="er">localhost:8000/api/books/A111B7</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;isbn&quot;</span><span class="fu">:</span> <span class="st">&quot;A111B7&quot;</span><span class="fu">,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;The Hobbit&quot;</span><span class="fu">,</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;author&quot;</span><span class="fu">:</span> <span class="st">&quot;J.R.R. Tolkien&quot;</span><span class="fu">,</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;pages&quot;</span><span class="fu">:</span> <span class="dv">-10</span><span class="fu">,</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;pub_date&quot;</span><span class="fu">:</span> <span class="st">&quot;2020-11-03&quot;</span><span class="fu">,</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;publisher&quot;</span><span class="fu">:</span> <span class="st">&quot;/api/publishers/2&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
            <h2 data-number="1.4"
            id="exercise-3.-authentication-and-authorization"><span
            class="header-section-number">1.4</span> Exercise 3.
            Authentication and authorization</h2>
            <p>The API will have 3 access levels:</p>
            <ul>
            <li><strong>Public access</strong>: can’t access the API,
            only to the registration and login url’s.</li>
            <li><strong>Registered users</strong>: can access all the
            API routes to <strong>list</strong> and
            <strong>view</strong> books and publishers (GET), but can
            not edit (PUT), delete (DELETE) or add (POST) any data.</li>
            <li><strong>Admin users</strong>: can access all the API
            routes and can edit, delete and add all the data.</li>
            </ul>
            <p>The authentication must be based in a user entity. The
            users will be stored using an entity named <code>User</code>
            in a table named <code>user</code>.</p>
            <p>The user fields to be stored are:</p>
            <ul>
            <li>Name (string, 100 characters, not null)</li>
            <li>Email</li>
            <li>Phone (string, 25 characters, can be null)</li>
            <li>Password</li>
            </ul>
            <p>The user’s identifier must be the <strong>email</strong>.
            And the password must be stored encrypted. It’s not
            necessary to send a confirmation email to the user to
            complete the register.</p>
            <p>Once done the table in the database, it should be:</p>
            <div class="sourceCode" id="cb4"><pre
            class="sourceCode sql"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mysql<span class="op">&gt;</span> describe <span class="fu">user</span>;</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">----------+--------------+------+-----+---------+----------------+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>| Field    | <span class="kw">Type</span>         | <span class="kw">Null</span> | <span class="kw">Key</span> | <span class="kw">Default</span> | Extra          |</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">----------+--------------+------+-----+---------+----------------+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>| <span class="kw">id</span>       | <span class="dt">int</span>          | <span class="kw">NO</span>   | PRI | <span class="kw">NULL</span>    | auto_increment |</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>| email    | <span class="dt">varchar</span>(<span class="dv">180</span>) | <span class="kw">NO</span>   | UNI | <span class="kw">NULL</span>    |                |</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>| <span class="kw">roles</span>    | json         | <span class="kw">NO</span>   |     | <span class="kw">NULL</span>    |                |</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>| <span class="kw">password</span> | <span class="dt">varchar</span>(<span class="dv">255</span>) | <span class="kw">NO</span>   |     | <span class="kw">NULL</span>    |                |</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>| name     | <span class="dt">varchar</span>(<span class="dv">100</span>) | <span class="kw">NO</span>   |     | <span class="kw">NULL</span>    |                |</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>| phone    | <span class="dt">varchar</span>(<span class="dv">25</span>)  | YES  |     | <span class="kw">NULL</span>    |                |</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="op">+</span><span class="co">----------+--------------+------+-----+---------+----------------+</span></span></code></pre></div>
            <blockquote>
            <p>In MariaDB the <code>roles</code> field can be
            <code>longtext</code>.</p>
            </blockquote>
            <p>Our app will have the next roles:</p>
            <ul>
            <li>Administrators, with the role
            <code>ROLE_ADMIN</code>.</li>
            <li>Registered users, with the role
            <code>ROLE_USER</code>.</li>
            <li>Unauthenticated users.</li>
            </ul>
            <p>Make the authentication based on tokens, using the
            <code>lexik/jwt-authentication-bundle</code> library. The
            authentication route must be
            <strong><code>/auth</code></strong> (only POST) and the
            registration route
            <strong><code>/api/register</code></strong> (only POST).</p>
            <h2 data-number="1.5"
            id="how-to-submit-to-github-classroom"><span
            class="header-section-number">1.5</span> How to submit to
            GitHub Classroom</h2>
            <p>Once you finish the task, make a commit with the comment
            “PRACTICE 13.1 SUBMISSION COMMIT” and push it to GitHub.
            Make a <strong>pull-request</strong> so that i could know
            your code is submitted.</p>
            <ol type="1">
            <li>This task must be submitted to the same repository of
            the previous one. Remember to make a new branch before
            starting the practice.</li>
            <li>Once you finish the task, make a commit with the comment
            “PRACTICE 13.1 SUBMISSION COMMIT”, merge the branch into the
            main branch, and push it to GitHub. For example:</li>
            </ol>
            <div class="sourceCode" id="cb5"><pre
            class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">&quot;PRACTICE 13.1 SUBMISSION COMMIT&quot;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout main</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> merge library-u13</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span></code></pre></div>
            <ol start="3" type="1">
            <li><p>It’s recommended to tag your commit with the tag
            “Practice_13.1”.</p></li>
            <li><p>Before that, you can do the commits and push you
            want. If you change your code after your submission commit,
            make another commit and push with the same text in the
            message adding the corrections you’ve done.</p></li>
            </ol>
            <p>If you have any doubt in your task, you can push your
            code and ask me by email what’s your problem. It will make
            it easier for both the solutions of code issues.</p>
        </main>
        

        <!--- Modal images -->

        <!-- The Modal -->
        <div id="myModal" class="modal">

            <!-- The Close Button -->
            <!--span class="close">&times;</span-->

            <!-- Modal Content (The Image) -->
            <img class="modal-content" id="img01">

            <!-- Modal Caption (Image Text) -->
            <div id="caption"></div>
        </div>

        <!-- End Modal Images -->

        <!-- Snackbar for copy code -->
        <div id="snackbar">Codi copiat!</div>
        <!-- End Snackbar -->

        <script>
            function ModalizeImages() {
                // Script basat en https://www.w3schools.com/howto/howto_css_modal_images.asp
                // PEr ampliar imatges en fer click

                // Get the modal
                var modal = document.getElementById("myModal");

                var modalImg = document.getElementById("img01");
                var captionText = document.getElementById("caption");

                // Get the image and insert it inside the modal - use its "alt" text as a caption
                //var img = document.getElementById("myImg");
                document.querySelectorAll("img").forEach((img => {
                        img.onclick = function() {
                            modal.style.display = "block";
                            modalImg.src = this.src;
                            captionText.innerHTML = this.alt;
                        }
                    }))
                    // Get the <span> element that closes the modal
                var span = document.getElementsByClassName("close")[0];

                // When the user clicks on <span> (x), close the modal
                //span.onclick = function() {
                myModal.onclick = function() {
                    modal.style.display = "none";
                }


            }


            function markItem(id) {
                // Restaurem format de tots
                document.querySelectorAll("#TOC a").forEach(function(item) {
                        //item.style.fontWeight = "300";
                        item.classList.remove("navItemSelected");
                    })
                    //item.style.color = "#ff0000";

                // Afegim format
                let items = document.querySelectorAll("#TOC a[href='#" + id + "']");
                items.forEach(function(item) {
                    //item.style.fontWeight = "bolder";
                    item.classList.add("navItemSelected");
                })

            }

            var observer = new IntersectionObserver(function(entries) {
                // isIntersecting is true when element and viewport are overlapping
                // isIntersecting is false when element and viewport don't overlap
                if (entries[0].isIntersecting === true) {
                    let id = entries[0].target.id;
                    markItem(id);
                }

            }, {
                threshold: [0]
            });

            window.addEventListener("load", function() {
                document.querySelectorAll("h1, h2, h3").forEach(function(item) {
                    observer.observe(item);
                });

                document.querySelectorAll("#TOC a").forEach(function(item) {
                    item.addEventListener("click", function(item) {
                        markItem(item.id);
                    })
                })

                // Fem modals totes les imatges
                ModalizeImages();
            })

            document.querySelector("#TOC").addEventListener("click", function(event) {
                let toc = event.target
                if (toc.offsetWidth > 10) {
                    toc.classList.add("minimizedToc");
                }
            })

            document.querySelector("#TOC").addEventListener("mouseover", function(event) {
                let toc = event.target
                if (toc.classList.contains("minimizedToc"))
                    toc.classList.remove("minimizedToc");
            })


                        
            /* PER COPIAR CODI */


            // Busca tots els elements amb la classe "sourceCode"
            var sourceCodeElements = document.querySelectorAll('div.sourceCode');

            /*Afegim el botó a tots els divs */
            // Afegir un botó per a cada element "sourceCode"
            sourceCodeElements.forEach(function(element) {
                console.log(element.id);
                var button = document.createElement('div');
                button.className = 'button-copy';

                // Afegir una icona al botó (fa servir FontAwesome com a exemple)
                //var icon = document.createElement('i');
                //icon.className = 'fas fa-copy'; // Utilitza l'ícona "copy" de FontAwesome

                // Obté l'ID de l'element actual
                var elementId = element.id;

                // Afegeix un event listener al botó per cridar la funció amb l'ID
                button.addEventListener('click', function() {
                    copyContent(elementId);
                });

                // Afegeix l'icona al botó i el botó just dins de l'element "sourceCode"
                //button.appendChild(icon);
                element.appendChild(button);
            });



            // Funció per copiar el contingut d'un element amb l'ID donat
            function copyContent(elementId) {
                var element = document.getElementById(elementId);
                var textToCopy = element.innerText;

                // Crea un element de text i copia el contingut
                var textArea = document.createElement('textarea');
                textArea.value = textToCopy;
                document.body.appendChild(textArea);

                // Selecciona i copia el text
                textArea.select();
                document.execCommand('copy');

                // Elimina l'element de text afegit temporalment
                document.body.removeChild(textArea);

                // Notifica a l'usuari que el codi s'ha copiat
                mostraSnackbar();
            }

            /* SNACKBAR EN COPIAR CODI */

            function mostraSnackbar() {
            // Busquem l'snackbar
            var x = document.getElementById("snackbar");

            // Li afegim la classe show
            x.className = "show";

            // I als tres segons la llevem
            setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
            } 




        </script>
    </div>
</body>

</html>